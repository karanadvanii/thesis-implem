<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta http-equiv="Content-Security-Policy" content="default-src * data: gap: content: https://ssl.gstatic.com; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
  <link rel="manifest" href="/manifest.json">
  <link rel="shortcut icon" href="images/icons/Icon-48.png" type="image/x-icon">
  <link rel="icon" href="images/icons/Icon-48.png" type="image/x-icon">
  <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
  <link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
  <link href='//fonts.googleapis.com/css?family=Oswald:400,300,700' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <title>Offline-First Mobile Application</title>
</head>
<body>
    <div class="topnav">
      <a href="index.html" class="active logo"
        ><img src="images/staffbase_ext.png"/></a>
      <div id="myLinks">
        <a href="author.html">Employee Directory</a>
        <a href="ceo.html">CEO's Messages</a>
        <a href="publicwall.html">Public Wall</a>
        <a href="important.html">Important Communication</a>
        <a href="handbook.html">Employee Handbook</a>
      </div>
      <a href="javascript:void(0);" class="icon" onclick="myFunction()">
        <i class="fa fa-bars"></i>
      </a>
    </div>
    <div id="status" class="online"> ONLINE </div>
        <div class="container">
          <div class="col-xs-12 col-sm-12 col-md-8 wrapper">
            <div class="row data-entry" id="slider-entry"></div>
            <div class="row data-entry" id="data-entry"></div>
            <div class="row data-entry" id="split-entry"></div>
          </div>
          <div class="col-xs-12 col-sm-12 col-md-4">
            <div class="col-xs-12 col-sm-12 col-md-12" class="rhs-heading">
              <h4>Quick Links</h4>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-12 frame-rhs">
              <a href="quicklinks.html#px" class="side-links">People Experience</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#cc" class="side-links">Customer Care</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#csm" class="side-links">Customer Success Manahement</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#dev" class="side-links">Development</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#pa" class="side-links">Partners / Alliances</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#prud" class="side-links">Product</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#sales" class="side-links">Sales</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#fin" class="side-links">Finance</a>
              <hr class="hr-side" />
              <a href="quicklinks.html#is" class="side-links">Information Security</a>
            </div>
            <br />
            <div class="col-xs-12 col-sm-12 col-md-12">
              <h4>HR Documents</h4>
            </div>
            <div class="col-xs-12 col-sm-12 col-md-12 frame-rhs">
              <a href="files/dummy4.pdf" class="side-links"><img src="images/pdf.png" height="20" width="20"/>&nbsp;&nbsp;Perks & Benefits</a>
              <hr class="hr-side" />
              <a href="files/dummy2.pdf" class="side-links"><img src="images/pdf.png" height="20" width="20"/>&nbsp;&nbsp;Values</a>
              <hr class="hr-side" />
              <a href="files/dummy3.pdf" class="side-links"><img src="images/pdf.png" height="20" width="20"/>&nbsp;&nbsp;Hiring</a>
              <hr class="hr-side" />
              <a href="files/dummy.pdf" class="side-links"><img src="images/pdf.png" height="20" width="20"/>&nbsp;&nbsp;HR FAQs</a>
            </div>
          </div>
        </div>
        <div class="clearfix"></div>
<!--        <script src="script/main.js"></script>-->
        <script src="script/jquery-1.11.1.min.js"></script>
        <script src="script/localforage.js"></script>
        <script src="script/db.js"></script>
        <script>
          if ('serviceWorker' in navigator) {
              window.addEventListener('load', function() {
                navigator.serviceWorker.register('/service-worker.js');
              });
          }
        </script>
        <script>
          function myFunction() {
            var x = document.getElementById("myLinks");
            if (x.style.display === "block") {
              x.style.display = "none";
            } else {
              x.style.display = "block";
            }
          }
        </script>
        <script>
        window.addEventListener('DOMContentLoaded', function() {
          var status = document.getElementById("status");

          function updateOnlineStatus(event) {
            var condition = navigator.onLine ? "online" : "offline";

            status.className = condition;
            status.innerHTML = condition.toUpperCase();
          }
          window.addEventListener('online',  updateOnlineStatus);
          window.addEventListener('offline', updateOnlineStatus);
        });
    </script>
    <script>
    function createNode(element) {
      return document.createElement(element);
    }

    function append(parent, el) {
      return parent.appendChild(el);
    }

    const API_KEY =
      "NWRkZDVkOTFlYTJkMTU3ZjYxNWIyOGYxOn59UlluXk55V0NdMn1YRE0wLF15cW1Kam8hUC1EYTR1OS1BSXtfRVZ6dG4wY3Npcnt7NlpXRElSbV1qbE1PeEo=";
    const source = "5e2629806199791aeb6d7441";
    const url = "https://de-t1.eyo.net/api/channels/" + source + "/posts";
    const container = document.getElementById("data-entry");

    let headers = new Headers();
    headers.append("Authorization", "Basic " + API_KEY);

    function getFullname(newsItem) {
        if (newsItem.author) {
            return `${newsItem.author.firstName} ${newsItem.author.lastName}`
        } else if (newsItem.source) {
            return `${newsItem.source.name}`
        }
    }

    function getAvatar(newsItem) {
        if (newsItem.author && newsItem.author.avatar) {
            return newsItem.author.avatar.thumb.url;
        }
        return "https://cdn-main-de1.staffbase.rocks/t1-backend/image/upload/c_crop,w_2707,h_2707,x_137,y_420/c_fill,w_200,h_200/v1579602614/3I1RsaQZIkint4Olt2GyAXWVYiHP7Yh4CzZS0DSkXKQohGgKakepnPpmrBPW2fioajP9eNmNZvQg9Gi281hdoITVDDNg5RBIRqifL65mDp6GRcVT2Ph6CGspSL6vgSec47JeThhKfzGYAueED6NXXXHb3CcxRk5mJDdN1MLGTTJ7mO0KPvdr1b2beZs3C5Bo/5ba8a05d0a09a25b017e08d3.jpeg";
    }

    fetch(url, { method: "GET", headers})
      .then(resp => resp.json())
      .then(function(data) {
        let newsList = data.data;
        return newsList.map(function(newsItem) {
          let div = createNode("div");
          div.className = `col-xs-12 col-sm-12 col-md-12 frame`;

          div.innerHTML =  `<div class="col-xs-12 col-sm-12 col-md-12 author-wrapper">
                                <div class="col-xs-3 col-sm-1 col-md-1 author-image">
                                    <a class="author-id" href="author-single.html?id=${newsItem.source ? newsItem.source.name : ''}"><img src=${getAvatar(newsItem)} class="img-responsive author-image-thumb"></a>
                                </div>
                                <div class="col-xs-9 col-sm-11 col-md-11 author-details">
                                    <p class="name"><a class="author-id" href="author-single.html?id=${newsItem.author ? newsItem.author.id : ''}">${getFullname(newsItem)}</a></p>
                                    <p class="date">${new Date(newsItem.updated).toDateString()}</p>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 article">
                                <a class="author-id" href="article-single.html?id=${newsItem.id}">
                                    <p class="content-title">${newsItem.contents.en_US.title}</p>
                                    <p class="content-teaser">${newsItem.contents.en_US.teaser}</p>
                                    <img src="${newsItem.contents.en_US.image ? newsItem.contents.en_US.image.original.url : ''}" class="article-image">
                                </a>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 data-likes">
                                <hr>
                                <img src="../images/001-heart.png">${newsItem.likes.total}<img src="../images/002-speech-bubble.png">${newsItem.comments.total}
                            </div>
                            <div class="clearfix"></div>`;
          append(container, div);

        }); 
      })
      .catch(function(error) {
        console.log(error);
      });
    </script>
    </body>
</html>
